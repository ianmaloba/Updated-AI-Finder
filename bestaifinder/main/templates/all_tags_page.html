{% extends "base.html" %}

{% block title %}All Tags{% endblock %}

{% block content %}
<div class="container">
    <h1 class="heading">ALL TAGS</h1>
    <p class="instruction-text">Select a tag to view its related tools.</p>
    <div class="row">
        <!-- Tags Column -->
        <div class="col-md-4">
            <div id="tags-list">
                <p id="tags-text">
                    {% for tag in tags %}
                        <span class="tag" data-slug="{{ tag|slugify }}">
                            <svg class="tag-icon" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 1024 1024">
                                <path class="icon-fill" fill="grey" d="m908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5c-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 0 0 .6 45.3l183.7 179.1l-43.4 252.9a31.95 31.95 0 0 0 46.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2c17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9l183.7-179.1c5-4.9 8.3-11.3 9.3-18.3c2.7-17.5-9.5-33.7-27-36.3M664.8 561.6l36.1 210.3L512 672.7L323.1 772l36.1-210.3l-152.8-149L417.6 382L512 190.7L606.4 382l211.2 30.7z"/>
                            </svg>
                            {{ tag }}
                        </span>{% if not forloop.last %} {% endif %}
                    {% endfor %}
                </p>
            </div>
        </div>
        
        <!-- Tools Column -->
        <div class="col-md-8">
            <div class="tools-section">
                <h3 style="color: red;" id="tag-title">Tools</h3>
                <div id="tools-list">
                    <p>Select a tag to see its tools.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const tags = document.querySelectorAll('.tag');
        const toolsList = document.getElementById('tools-list');
        const tagTitle = document.getElementById('tag-title');
        
        // Handle tag click
        tags.forEach(tag => {
            tag.addEventListener('click', function() {
                // Remove bold from all tags
                tags.forEach(t => {
                    t.style.fontWeight = 'normal';
                    t.style.color = '';
                    t.querySelector('.icon-fill').setAttribute('fill', 'grey'); // Reset icon color
                });
                
                // Add bold to clicked tag
                this.style.fontWeight = 'bold';
                this.style.color = 'red';
                this.querySelector('.icon-fill').setAttribute('fill', 'red'); // Change icon color on click
                
                // Fetch tools for the selected tag
                fetch(`/tag-tools/?tag_slug=${this.dataset.slug}`)
                    .then(response => response.json())
                    .then(data => {
                        let toolsHtml = '';
                        data.tools.forEach((tool, index) => {
                            toolsHtml += `${index > 0 ? ' ' : ''}<svg xmlns="http://www.w3.org/2000/svg" width="12px" height="12px" viewBox="0 0 512 512"><path fill="grey" d="M58.79 439.13A16 16 0 0 1 48 424c0-73.1 14.68-131.56 43.65-173.77c35-51 90.21-78.46 164.35-81.87V88a16 16 0 0 1 27.05-11.57l176 168a16 16 0 0 1 0 23.14l-176 168A16 16 0 0 1 256 424v-79.77c-45 1.36-79 8.65-106.07 22.64c-29.25 15.12-50.46 37.71-73.32 67a16 16 0 0 1-17.82 5.28Z"/></svg> <a href="/ai-tool/${tool.slug}" style="font-size: smaller;">${tool.ai_name}</a>`;
                        });
                        toolsList.innerHTML = toolsHtml;
                        
                        // Update the tag title
                        tagTitle.textContent = `${this.textContent}-Related Tools`;
                    });
            });
        });
        
        // Trigger click on the first tag by default
        if (tags.length > 0) {
            tags[0].click();
        }
    });
</script>

<style>
    .tools-section {
        border: 1px solid black;
        border-radius: 8px; /* Curved corners */
        padding: 15px;
    }

    .instruction-text {
        color: blue;
        margin-bottom: 15px; /* Space below the instruction text */
    }

    .tag {
        font-size: smaller; /* Make tags smaller */
        cursor: pointer; /* Indicate clickable items */
        display: inline-flex;
        align-items: center;
        margin-right: 5px; /* Small space between tags */
    }

    .tag-icon {
        margin-right: 5px; /* Space between icon and text */
    }
</style>
{% endblock %}
